// -----------------------------------------------------------------------
// <copyright file="encryptedTransportAccount.tsp" company="Microsoft Corporation">
// Copyright (c) Microsoft Corporation. All rights reserved.
// </copyright>
// -----------------------------------------------------------------------
import "@typespec/http";
import "@typespec/rest";
import "@azure-tools/typespec-autorest";
import "@azure-tools/typespec-azure-core";
import "@azure-tools/typespec-azure-resource-manager";

using TypeSpec.Http;
using TypeSpec.Rest;
using TypeSpec.Versioning;
using Azure.ResourceManager;
using Azure.Core;

namespace Microsoft.EncryptedTransport;

@doc("Encrypted Transport Account Resource Type")
model EncryptedTransportAccount
  is TrackedResource<EncryptedTransportAccountProperties> {
  @doc("The encrypted transport account name")
  @key("encryptedTransportAccountName")
  @visibility(Lifecycle.Read)
  @segment("encryptedTransportAccounts")
  @pattern("^[a-zA-Z0-9-]{3,64}$")
  @path
  name: string;
}

@doc("Encrypted Transport Account Properties")
model EncryptedTransportAccountProperties {
  @doc("Wi-Fi Pre-Shared Key as printable ASCII string")
  @pattern("^[ -~ ]{8,64}$")
  @visibility(Lifecycle.Create)
  @secret
  @added(Microsoft.EncryptedTransport.Versions.v2024_09_01_preview)
  @removed(Microsoft.EncryptedTransport.Versions.v2025_10_01_preview)
  wifiPsk: string;

  @doc("List of Wi-Fi Pre-Shared Keys as printable ASCII secure strings")
  @visibility(Lifecycle.Create, Lifecycle.Update)
  @added(Microsoft.EncryptedTransport.Versions.v2025_10_01_preview)
  wifiPsks: WifiPsk[];

  @doc("Reference to an existing subnet in the customer's Azure virtual network")
  @visibility(Lifecycle.Create, Lifecycle.Read)
  subnetId: SubnetId;

  @doc("Bandwidth can only be 500, 1000, 2000, 5000, or 10000 Mbps")
  @added(Microsoft.EncryptedTransport.Versions.v2024_09_01_preview)
  @removed(Microsoft.EncryptedTransport.Versions.v2025_10_01_preview)
  @visibility(Lifecycle.Create, Lifecycle.Read, Lifecycle.Update)
  bandwidth: EncryptedTransportAccountBandwidthOptions;

  @doc("Private IP address of the account, generated by the service")
  @visibility(Lifecycle.Read)
  privateIpAddress: Azure.Core.ipV4Address[];

  @doc("The status of the last operation.")
  @visibility(Lifecycle.Read)
  provisioningState?: ProvisioningState;
}

@doc("Encrypted Transport Account bandwidth options in Mbps")
@added(Microsoft.EncryptedTransport.Versions.v2024_09_01_preview)
@removed(Microsoft.EncryptedTransport.Versions.v2025_10_01_preview)
union EncryptedTransportAccountBandwidthOptions {
  @doc("500 Mbps")
  Mbps500: "Mbps500",

  @doc("1000 Mbps")
  Mbps1000: "Mbps1000",

  @doc("2000 Mbps")
  Mbps2000: "Mbps2000",

  @doc("5000 Mbps")
  Mbps5000: "Mbps5000",

  @doc("10000 Mbps")
  Mbps10000: "Mbps10000",

  string,
}

@doc("Secure string wifi PSK")
@pattern("^[ -~ ]{8,64}$")
@secret
@added(Microsoft.EncryptedTransport.Versions.v2025_10_01_preview)
scalar WifiPsk extends string;

/* https://azure.github.io/typespec-azure/docs/howtos/ARM/resource-type#using-resource-identifiers */
@doc("Subnet Resource Identifier of the subnet in the customer vnet")
scalar SubnetId
  extends Azure.Core.armResourceIdentifier<[
    {
      type: "Microsoft.Network/virtualNetworks/subnets",
    }
  ]>;

@armResourceOperations
interface EncryptedTransportAccountOperations {
  get is ArmResourceRead<EncryptedTransportAccount>;
  createOrUpdate is ArmResourceCreateOrReplaceAsync<EncryptedTransportAccount>;
  update is ArmResourcePatchSync<
    EncryptedTransportAccount,
    EncryptedTransportAccountProperties
  >;
  delete is ArmResourceDeleteWithoutOkAsync<EncryptedTransportAccount>;
  listByResourceGroup is ArmResourceListByParent<EncryptedTransportAccount>;
  listBySubscription is ArmListBySubscription<EncryptedTransportAccount>;
}
